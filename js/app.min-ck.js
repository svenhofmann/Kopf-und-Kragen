/*
 * Swipe 2.0
 *
 * Brad Birdsall
 * Copyright 2013, MIT License
 *
*/function Swipe(e,t){"use strict";function n(){m=v.children;b=m.length;m.length<2&&(t.continuous=!1);if(d.transitions&&t.continuous&&m.length<3){v.appendChild(m[0].cloneNode(!0));v.appendChild(v.children[1].cloneNode(!0));m=v.children}g=new Array(m.length);y=e.getBoundingClientRect().width||e.offsetWidth;v.style.width=m.length*y+"px";var n=m.length;while(n--){var r=m[n];r.style.width=y+"px";r.setAttribute("data-index",n);if(d.transitions){r.style.left=n*-y+"px";u(n,w>n?-y:w<n?y:0,0)}}if(t.continuous&&d.transitions){u(s(w-1),-y,0);u(s(w+1),y,0)}d.transitions||(v.style.left=w*-y+"px");e.style.visibility="visible"}function r(){t.continuous?o(w-1):w&&o(w-1)}function i(){t.continuous?o(w+1):w<m.length-1&&o(w+1)}function s(e){return(m.length+e%m.length)%m.length}function o(e,n){if(w==e)return;if(d.transitions){var r=Math.abs(w-e)/(w-e);if(t.continuous){var i=r;r=-g[s(e)]/y;r!==i&&(e=-r*m.length+e)}var o=Math.abs(w-e)-1;while(o--)u(s((e>w?e:w)-o-1),y*r,0);e=s(e);u(w,y*r,n||E);u(e,0,n||E);t.continuous&&u(s(e-r),-(y*r),0)}else{e=s(e);f(w*-y,e*-y,n||E)}w=e;p(t.callback&&t.callback(w,m[w]))}function u(e,t,n){a(e,t,n);g[e]=t}function a(e,t,n){var r=m[e],i=r&&r.style;if(!i)return;i.webkitTransitionDuration=i.MozTransitionDuration=i.msTransitionDuration=i.OTransitionDuration=i.transitionDuration=n+"ms";i.webkitTransform="translate("+t+"px,0)"+"translateZ(0)";i.msTransform=i.MozTransform=i.OTransform="translateX("+t+"px)"}function f(e,n,r){if(!r){v.style.left=n+"px";return}var i=+(new Date),s=setInterval(function(){var o=+(new Date)-i;if(o>r){v.style.left=n+"px";S&&l();t.transitionEnd&&t.transitionEnd.call(event,w,m[w]);clearInterval(s);return}v.style.left=(n-e)*(Math.floor(o/r*100)/100)+e+"px"},4)}function l(){x=setTimeout(i,S)}function c(){S=0;clearTimeout(x)}var h=function(){},p=function(e){setTimeout(e||h,0)},d={addEventListener:!!window.addEventListener,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,transitions:function(e){var t=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"];for(var n in t)if(e.style[t[n]]!==undefined)return!0;return!1}(document.createElement("swipe"))};if(!e)return;var v=e.children[0],m,g,y,b;t=t||{};var w=parseInt(t.startSlide,10)||0,E=t.speed||300;t.continuous=t.continuous!==undefined?t.continuous:!0;var S=t.auto||0,x,T={},N={},C,k={handleEvent:function(e){switch(e.type){case"touchstart":this.start(e);break;case"touchmove":this.move(e);break;case"touchend":p(this.end(e));break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"otransitionend":case"transitionend":p(this.transitionEnd(e));break;case"resize":p(n.call())}t.stopPropagation&&e.stopPropagation()},start:function(e){var t=e.touches[0];T={x:t.pageX,y:t.pageY,time:+(new Date)};C=undefined;N={};v.addEventListener("touchmove",this,!1);v.addEventListener("touchend",this,!1)},move:function(e){if(e.touches.length>1||e.scale&&e.scale!==1)return;t.disableScroll&&e.preventDefault();var n=e.touches[0];N={x:n.pageX-T.x,y:n.pageY-T.y};typeof C=="undefined"&&(C=!!(C||Math.abs(N.x)<Math.abs(N.y)));if(!C){e.preventDefault();c();if(t.continuous){a(s(w-1),N.x+g[s(w-1)],0);a(w,N.x+g[w],0);a(s(w+1),N.x+g[s(w+1)],0)}else{N.x=N.x/(!w&&N.x>0||w==m.length-1&&N.x<0?Math.abs(N.x)/y+1:1);a(w-1,N.x+g[w-1],0);a(w,N.x+g[w],0);a(w+1,N.x+g[w+1],0)}}},end:function(e){var n=+(new Date)-T.time,r=Number(n)<250&&Math.abs(N.x)>20||Math.abs(N.x)>y/2,i=!w&&N.x>0||w==m.length-1&&N.x<0;t.continuous&&(i=!1);var o=N.x<0;if(!C)if(r&&!i){if(o){if(t.continuous){u(s(w-1),-y,0);u(s(w+2),y,0)}else u(w-1,-y,0);u(w,g[w]-y,E);u(s(w+1),g[s(w+1)]-y,E);w=s(w+1)}else{if(t.continuous){u(s(w+1),y,0);u(s(w-2),-y,0)}else u(w+1,y,0);u(w,g[w]+y,E);u(s(w-1),g[s(w-1)]+y,E);w=s(w-1)}t.callback&&t.callback(w,m[w])}else if(t.continuous){u(s(w-1),-y,E);u(w,0,E);u(s(w+1),y,E)}else{u(w-1,-y,E);u(w,0,E);u(w+1,y,E)}v.removeEventListener("touchmove",k,!1);v.removeEventListener("touchend",k,!1)},transitionEnd:function(e){if(parseInt(e.target.getAttribute("data-index"),10)==w){S&&l();t.transitionEnd&&t.transitionEnd.call(e,w,m[w])}}};n();S&&l();if(d.addEventListener){d.touch&&v.addEventListener("touchstart",k,!1);if(d.transitions){v.addEventListener("webkitTransitionEnd",k,!1);v.addEventListener("msTransitionEnd",k,!1);v.addEventListener("oTransitionEnd",k,!1);v.addEventListener("otransitionend",k,!1);v.addEventListener("transitionend",k,!1)}window.addEventListener("resize",k,!1)}else window.onresize=function(){n()};return{setup:function(){n()},slide:function(e,t){c();o(e,t)},prev:function(){c();r()},next:function(){c();i()},getPos:function(){return w},getNumSlides:function(){return b},kill:function(){c();v.style.width="auto";v.style.left=0;var e=m.length;while(e--){var t=m[e];t.style.width="100%";t.style.left=0;d.transitions&&a(e,0,0)}if(d.addEventListener){v.removeEventListener("touchstart",k,!1);v.removeEventListener("webkitTransitionEnd",k,!1);v.removeEventListener("msTransitionEnd",k,!1);v.removeEventListener("oTransitionEnd",k,!1);v.removeEventListener("otransitionend",k,!1);v.removeEventListener("transitionend",k,!1);window.removeEventListener("resize",k,!1)}else window.onresize=null}}}(window.jQuery||window.Zepto)&&function(e){e.fn.Swipe=function(t){return this.each(function(){e(this).data("Swipe",new Swipe(e(this)[0],t))})}}(window.jQuery||window.Zepto);(function(e){"use strict";function t(e){this.callback=e;this.ticking=!1}function n(e,r){r=r||n.options;this.lastKnownScrollY=0;this.elem=e;this.debouncer=new t(this.update.bind(this));this.tolerance=r.tolerance;this.classes=r.classes;this.offset=r.offset;this.initialised=!1}window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;t.prototype={constructor:t,update:function(){this.callback&&this.callback();this.ticking=!1},requestTick:function(){if(!this.ticking){requestAnimationFrame(this.update.bind(this));this.ticking=!0}},handleEvent:function(){this.requestTick()}};n.prototype={constructor:n,init:function(){this.elem.classList.add(this.classes.initial);setTimeout(this.attachEvent.bind(this),100)},destroy:function(){this.initialised=!1;window.removeEventListener("scroll",this.debouncer,!1);this.elem.classList.remove(this.classes.unpinned,this.classes.pinned,this.classes.initial)},attachEvent:function(){if(!this.initialised){this.initialised=!0;window.addEventListener("scroll",this.debouncer,!1)}},unpin:function(){this.elem.classList.add(this.classes.unpinned);this.elem.classList.remove(this.classes.pinned)},pin:function(){this.elem.classList.remove(this.classes.unpinned);this.elem.classList.add(this.classes.pinned)},getScrollY:function(){return window.pageYOffset!==undefined?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop},update:function(){var e=this.getScrollY(),t=Math.abs(e-this.lastKnownScrollY)>=this.tolerance;if(e<0)return;t&&(e>this.lastKnownScrollY&&e>=this.offset?this.unpin():e<this.lastKnownScrollY&&this.pin());this.lastKnownScrollY=e}};n.options={tolerance:0,offset:0,classes:{pinned:"headroom--pinned",unpinned:"headroom--unpinned",initial:"headroom"}};e.Headroom=n})(this);(function(e){e.fn.headroom=function(t){return this.each(function(){var n=e(this),r=n.data("headroom"),i=typeof t=="object"&&t;i=e.extend(!0,{},Headroom.options,i);if(!r){r=new Headroom(this,i);r.init();n.data("headroom",r)}typeof t=="string"&&r[t]()})};e("[data-headroom]").each(function(){var t=e(this);t.headroom(t.data())})})(window.Zepto||window.jQuery);var MF=function(e,t){"use strict";function n(){r(u);i(a);s()}function r(e){e.each(function(e){var n=t(this),r=t(".swipe-slider__nav",n),i='<ul class="nav nav--prev-next"><li><a href="javascript:void(0)" class="swipe__prev icon-arrow-left">☜</a></li><li><b class="current">1</b>/<b class="all">1</b></li><li><a href="javascript:void(0)" class="swipe__next icon-arrow-right">☞</a></li></ul>';n.wrapInner('<div class="swipe-wrap"/>');r.length?r.append(i):n.append(i);swipes[e]=new Swipe(n[0],{startSlide:0,speed:300,auto:0,continuous:!0,disableScroll:!1,stopPropagation:!1,callback:function(e,r){t(".current",n).text(e+1)},transitionEnd:function(e,t){}});t(".all",n).text(swipes[e].getNumSlides());n.on(f,".swipe__prev, .swipe__next",function(n){n.preventDefault();var r=t(this);r.hasClass("swipe__prev")?swipes[e].prev():swipes[e].next();return!1})})}function i(e){e.headroom({tolerance:10,offset:100,classes:{initial:"animated",pinned:"slideDown",unpinned:"slideUp"}})}function s(){if(!Modernizr.touch){var e=document.body,t;window.addEventListener("scroll",function(){clearTimeout(t);e.classList.contains("disable-hover")||e.classList.add("disable-hover");t=setTimeout(function(){e.classList.remove("disable-hover")},200)},!1)}}var o=e.siteFunctions=e.siteFunctions||{},u=t(".swipe"),a=t("#header"),f=Modernizr.touch?"touchstart":"click";window.swipes=[];o.init=function(){n()};return e}(MF||{},jQuery);MF.siteFunctions.init();